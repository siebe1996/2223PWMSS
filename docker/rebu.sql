-- MySQL Script generated by MySQL Workbench
-- Tue Oct 25 10:56:55 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema rebu
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `rebu` ;

-- -----------------------------------------------------
-- Schema rebu
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `rebu` DEFAULT CHARACTER SET utf8mb4 DEFAULT  COLLATE  utf8mb4_unicode_ci;
USE `rebu` ;

-- -----------------------------------------------------
-- Table `rebu`.`anonymous_users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `rebu`.`anonymous_users` ;

CREATE TABLE IF NOT EXISTS `rebu`.`anonymous_users` (
                                                        `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
                                                        `email` VARCHAR(255) NOT NULL,
                                                        `first_name` VARCHAR(45) NOT NULL,
                                                        `last_name` VARCHAR(127) NOT NULL,
                                                        PRIMARY KEY (`id`))
    ENGINE = InnoDB;

CREATE UNIQUE INDEX `id_UNIQUE` ON `rebu`.`anonymous_users` (`id` ASC) VISIBLE;

CREATE UNIQUE INDEX `email_UNIQUE` ON `rebu`.`anonymous_users` (`email` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `rebu`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `rebu`.`users` ;

CREATE TABLE IF NOT EXISTS `rebu`.`users` (
                                              `id` INT UNSIGNED NOT NULL,
                                              `password` VARCHAR(255) DEFAULT NULL,
                                              `verified` TINYINT NOT NULL DEFAULT 0,
                                              `verification_code` VARCHAR(16) NOT NULL,
                                              PRIMARY KEY (`id`),
                                              CONSTRAINT `userid`
                                                  FOREIGN KEY (`id`)
                                                      REFERENCES `rebu`.`anonymous_users` (`id`)
                                                      ON DELETE NO ACTION
                                                      ON UPDATE NO ACTION)
    ENGINE = InnoDB;

CREATE UNIQUE INDEX `id_UNIQUE` ON `rebu`.`users` (`id` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `rebu`.`drivers`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `rebu`.`drivers` ;

CREATE TABLE IF NOT EXISTS `rebu`.`drivers` (
                                                `id` INT UNSIGNED NOT NULL,
                                                `btw_nr` VARCHAR(12) NOT NULL,
                                                `number_plate` VARCHAR(7) NOT NULL,
                                                `birth_date` TIMESTAMP NOT NULL,
                                                `car_seats` INT UNSIGNED NOT NULL,
                                                `car_model` VARCHAR(45) NOT NULL,
                                                `car_brand` VARCHAR(45) NOT NULL,
                                                `actief` TINYINT NOT NULL DEFAULT 0,
                                                `gender` ENUM('M', 'F', 'X') NOT NULL,
                                                `profile_pic` VARCHAR(45) NOT NULL,
                                                PRIMARY KEY (`id`),
                                                CONSTRAINT `driver`
                                                    FOREIGN KEY (`id`)
                                                        REFERENCES `rebu`.`users` (`id`)
                                                        ON DELETE NO ACTION
                                                        ON UPDATE NO ACTION)
    ENGINE = InnoDB;

CREATE UNIQUE INDEX `idd_UNIQUE` ON `rebu`.`drivers` (`id` ASC) VISIBLE;

CREATE UNIQUE INDEX `btw_nr_UNIQUE` ON `rebu`.`drivers` (`btw_nr` ASC) VISIBLE;

CREATE UNIQUE INDEX `nummerplaat_UNIQUE` ON `rebu`.`drivers` (`number_plate` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `rebu`.`trips`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `rebu`.`trips` ;

CREATE TABLE IF NOT EXISTS `rebu`.`trips` (
                                              `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
                                              `start_nr` VARCHAR(5) NOT NULL,
                                              `start_street` VARCHAR(255) NOT NULL,
                                              `start_city` VARCHAR(45) NOT NULL,
                                              `stop_nr` VARCHAR(255) NOT NULL,
                                              `stop_street` VARCHAR(45) NOT NULL,
                                              `stop_city` VARCHAR(45) NOT NULL,
                                              `start_time` DATETIME NOT NULL,
                                              `stop_time` DATETIME DEFAULT NULL,
                                              `costumer_id` INT UNSIGNED NOT NULL,
                                              `driver_id` INT UNSIGNED DEFAULT NULL,
                                              `price` DECIMAL(5,2) UNSIGNED NOT NULL,
                                              `status` ENUM('pending', 'claimed', 'cancelled', 'started', 'finished') NOT NULL DEFAULT 'pending',
                                              PRIMARY KEY (`id`),
                                              CONSTRAINT `costumer`
                                                  FOREIGN KEY (`costumer_id`)
                                                      REFERENCES `rebu`.`anonymous_users` (`id`)
                                                      ON DELETE NO ACTION
                                                      ON UPDATE NO ACTION,
                                              CONSTRAINT `driverreview`
                                                  FOREIGN KEY (`driver_id`)
                                                      REFERENCES `rebu`.`drivers` (`id`)
                                                      ON DELETE NO ACTION
                                                      ON UPDATE NO ACTION)
    ENGINE = InnoDB;

CREATE UNIQUE INDEX `idt_UNIQUE` ON `rebu`.`trips` (`id` ASC) VISIBLE;

CREATE INDEX `costumer_idx` ON `rebu`.`trips` (`costumer_id` ASC) VISIBLE;

CREATE INDEX `driver_idx` ON `rebu`.`trips` (`driver_id` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `rebu`.`reviews`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `rebu`.`reviews` ;

CREATE TABLE IF NOT EXISTS `rebu`.`reviews` (
                                                `id` INT UNSIGNED NOT NULL,
                                                `rating` DECIMAL(2,1) NOT NULL,
                                                `review` TEXT NOT NULL,
                                                `trip_id` INT UNSIGNED NOT NULL,
                                                PRIMARY KEY (`id`),
                                                CONSTRAINT `trip`
                                                    FOREIGN KEY (`trip_id`)
                                                        REFERENCES `rebu`.`trips` (`id`)
                                                        ON DELETE NO ACTION
                                                        ON UPDATE NO ACTION)
    ENGINE = InnoDB;

CREATE UNIQUE INDEX `id_UNIQUE` ON `rebu`.`reviews` (`id` ASC) VISIBLE;

CREATE INDEX `trip_idx` ON `rebu`.`reviews` (`trip_id` ASC) VISIBLE;

-- CREATE VIEW `users_view` AS select anonymous_users.id, email, first_name, last_name, users.password from anonymous_users inner join users on users.id = anonymous_users.id;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

--
-- Dumping data for table `anonymous_users`
--

INSERT INTO `anonymous_users` (`id`, `email`, `first_name`, `last_name`) VALUES
                                                                             (1, 'lukasdownes@gmail.com', 'l', 'd'),
                                                                             (5, 'lukas.downes@student.odisee.be', 'lukas', 'downes');
-- --------------------------------------------------------

--
-- Dumping data for table `users`
--

INSERT INTO `users` (`id`, `password`, `verified`, `verification_code`) VALUES
                                                                            (1, '$argon2id$v=19$m=65536,t=4,p=1$clZkcFVacFVBRnZqb0pRbA$/3QBfdkYwdlTJfzP5nlW15bcc3SpWBQLEG9bx+/MPbQ', 1, 'MIZWPJTDVFBORYKG'),
                                                                            (5, '$argon2id$v=19$m=65536,t=4,p=1$bDJPRC52MDJRN3lQbUZkSg$XYNUDZylw2QeXZ08h8BJZIEPo2BPwcWzjUQsuSp64n0', 1, 'EZQBCHGVFJWTYRLN');
-- --------------------------------------------------------

--
-- Dumping data for table `drivers`
--

INSERT INTO `drivers` (`id`, `btw_nr`, `number_plate`, `birth_date`, `car_seats`, `car_model`, `car_brand`, `actief`, `gender`, `profile_pic`) VALUES
    (1, 'BE13548547', '1dle884', '1996-03-13 00:00:00', 3, 'm', 'bm', 0, 'F', '1.jpg');
-- --------------------------------------------------------

--
-- Dumping data for table `trips`
--

INSERT INTO `trips` (`id`, `start_nr`, `start_street`, `start_city`, `stop_nr`, `stop_street`, `stop_city`, `start_time`, `stop_time`, `costumer_id`, `driver_id`, `price`, `status`) VALUES
                                                                                                                                                                                          (1, '46', 'elfjulistraat', '9000 Gent', '46', 'henri vieuxtempsstraat', '1070 Anderlecht', '2023-02-14 14:52:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (2, '452', 'regrqe', 'qgfeZFzf', '46', 'sqfq', 'sqfde', '2023-01-12 16:05:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (3, '46', 'dfEF', 'qsdf', '66', 'sqf', 'qdsfsqdfq', '2023-01-12 15:41:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (4, '16', 'henri vieuxtempsstraat', '1070 Anderlecht', '46', 'elfjulistraat', '9000 Gent', '2023-01-11 20:50:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (5, '16', 'henri vieuxtempsstraat', 'Anderlecht', '46', 'elfjulistraat', 'Gent', '2024-02-12 21:00:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (6, '46', 'henri vieuxtempsstraat', 'Gent', '46', 'elfjulistraat', 'Anderlecht', '2024-03-12 00:04:00', NULL, 1, 1, '0.00', 'cancelled'),
                                                                                                                                                                                          (7, '452', 'elfjulistraat', 'gent', '61', 'henri vieuxtempsstraat', 'downes', '2024-02-10 00:05:00', NULL, 1, 1, '0.00', 'finished'),
                                                                                                                                                                                          (8, '16', 'lukas', 'gent', '16', 'Downes', 'Gent', '2024-02-12 00:17:00', NULL, 5, 1, '0.00', 'finished'),
                                                                                                                                                                                          (9, '123', 'Azerty', 'Qwerty', '123', 'Qwerty', 'Azerty', '2027-03-12 00:18:00', NULL, 5, 1, '0.00', 'cancelled'),
                                                                                                                                                                                          (10, '16', 'henri vieuxtempsstraat', 'Anderlecht', '46', 'elfjulistraat', 'Gent', '2024-02-13 17:05:00', NULL, 5, 1, '109.52', 'finished'),
                                                                                                                                                                                          (11, '116', 'Meir', 'Antwerpen', '46', 'elfjulistraat', 'Gent', '2024-02-13 19:25:00', NULL, 5, 1, '237.35', 'finished'),
                                                                                                                                                                                          (12, '16', 'henri vieuxtempsstraat', 'Anderlecht', '46', 'elfjulistraat', 'Gent', '2024-02-13 20:15:00', NULL, 5, 1, '0.00', 'finished'),
                                                                                                                                                                                          (13, '33', 'Nieuwstraat', 'Brussel', '16', 'henri vieuxtempsstraat', 'Anderlecht', '2024-02-13 20:19:00', NULL, 5, NULL, '20.29', 'pending');
-- --------------------------------------------------------